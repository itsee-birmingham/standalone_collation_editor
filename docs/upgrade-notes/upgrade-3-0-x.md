---
id: upgrade-3-0-x
title: Upgrade to 3.0.x family from 2.0.x
sidebar_label: Upgrading to 3.0.x
---

# Catena Dev branch changes (3.0.0 release candidate)

- Optional services and project setting *storeMultipleSupportLabelsAsParents* added which changes the behaviour of the label editing in order readings and stores support for multiple readings using the reading data itself so that it can be preserved and updated when readings are reordered. If this setting is used and set to true it will not have any impact on existing data but will offer the new label storage option for existing data. 
- Optional services and project setting *useZvForAllReadingsSupport* added. This setting only works if *storeMultipleSupportLabelsAsParents* is also set to true. If this settings is true then when editing the label in order readings if all possible parent witnesses are selected as readings which could be supported by the current reading then the label used internally will be 'zv' and it will show in the collation editor with ?.
- Optional project setting *witnessDecorators* added. This is not available at the services level as the data will be specific to each project. The structure is explained above in the optional project settings section. If data is provided then all hands from that witness will have the label appended after them in the hover overs of the collation editor. This was introduced to provide an easy way to see a group of manuscripts when the grouping was not otherwise made obvious in the sigla. The specific example from the New Testament is the use of a superscript K to make commentary manuscripts more easily identifiable.
- Optional services and project setting *omCategories* added which allows the user to specificy a set of labels as strings to use as subcategories for om readings.
- Optional services and project setting *allowJoiningAcrossCollationUnits* added which, if set to true, allows readings to be joined across collation unit boundaries. The collation editor itself only sets a flag on the reading to identify the join. It is up to all exporters to respect this in the export. There is no sanity checking on the flags, they rely on the editor being accurate.
- Optional services and project setting *allowCommentsOnRegRules* added. This is a boolean which determines whether or not to show the comments box in the regularisation rule menu. This also involves a change in the default behaviour which will not show the comments box by default. To maintain existing beaviour this boolean should be set to true.
- Optional services and project setting *allowOutOfOrderWitnesses* added along with *witnessesAllowedToBeOutOfOrder*. These settings are explained in the documentation above. The defaults maintain existing behaviour.
- In exporter.py there is a breaking change in the ```get_text()```, ```make_reading()``` and ```get_label()``` function arguments. The argument 'type' which used to be the string 'subreading' or None is now a boolean called 'is_subreading'. All calls to this function in exporters which inherit from this will need to be changed accordingly.
- Exported XML apparatus uses the n attribute for the identifier of ```<ab>``` elements rather than xml:id. The value of the attribute remains unchanged.
- In exporter.py ```get_lemma_text()``` now takes start and end arguments as strings. This is important for dealing with joined units in inheriting exporters.
- In exporter.py ```get_text()``` when om and lac are returned their string value is always returned with the full stop eg. ```om.```
- In exporter.py there is a new function ```get_required_end()```. This is irrelevant in this particular exporter but is important in exporters which build on this one and which are required to make joins across collation unit boundaries. This function can be overwritten in inheriting exporters to allow the correct data for the end of the unit to be set in the XML.
- In exporter.py there is a small change to the way the ```overtext``` argument passed into ```get_app_units()``` is structured. it is now calculated in the ```get_overtext_data()``` function. The new structure puts the older overtext data in a dictionary as the value for the key 'current'. The change has been made to allow for readings to be joined over collation unit boundaries. The core code does not support joining over collation unit boundaries but exporters which inherit from exporter.py may want to use this new function. If this function is being overridden in inheriting exporters then the ```get_lemma_text()``` function must also be updated for the structure produced by ```get_overtext_data()```.
- A very small change to the way pre-stage checks are implemented. If no message is provided in the configuration then no alert will be displayed, the result of the check will still be followed so if a test fails the unit will not progress to the next stage. This was done so that confirm boxes can be used in the code of the check itself to use warnings that can be overridden by the user, in these cases it should be the result of the confirmation which is passed back as the results of the checks.
- The message on a successful save has been changed from 'Save successful' to 'Last saved:' with a time stamp.
- The collation data is now simplified at the very start of the exporter process. Generally this involved removing keys that are not used but the overtext is also restructured as part of this process and therefore any functions which access the overtext such as ```get_lemma_text()``` will need to be updated to reflect the new, simpler structure. Instead of the tokens being accessesed via ```overtext[0]['tokens']``` they are now directly in ```overtext```.
